language: php

php:
  - 5.6

env:
  global:
    - setup=develop
    - APP_ENV=local
    - APP_DEBUG=true
    - APP_KEY=wRIAX0ss8ygHTT5cD9sGzLVwHCqLNU3U
    - DB_CONNECTION=mysql
    - DB_DATABASE=elsa_blog
    - DB_USERNAME=root
    - CACHE_DRIVER=file
    - SESSION_DRIVER=file
    - QUEUE_DRIVER=sync

#matrix:
#  include:
#    - php: 5.6
#      env: setup=develop
#    - php: 5.6
#      env: setup=staging
#    - php: 5.6
#      env: setup=production

sudo: false

services:
  - mysql

mysql:
  database: elsa_blog
  username: root
  encoding: utf8

before_script:
  - mysql -u root -e 'create database elsa_blog;'

before_install:
  - cd sources
  - composer self-update

install:
  - composer install --no-interaction --prefer-dist
#  - if [[ $setup = 'develop' ]]; then travis_retry composer install --no-interaction --prefer-dist; fi
#  - if [[ $setup = 'staging' ]]; then travis_retry composer update --prefer-dist --no-interaction --prefer-stable; fi
#  - if [[ $setup = 'production' ]]; then travis_retry composer update --prefer-dist --no-interaction --prefer-lowest --prefer-stable; fi

script: vendor/bin/phpunit